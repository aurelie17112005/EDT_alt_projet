"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[398],{715:function(e,t,s){s.d(t,{A:function(){return h}});var r=s(7858),n=s(9945),o=s(4582),i=s(8937),a=s(1582),l=s(5471),c=l.Ay.extend({name:"transitionable",props:{mode:String,origin:String,transition:String}}),d=s(2006),u=s(3803),h=(0,d.A)(r.A,i.A,c).extend({name:"v-alert",props:{border:{type:String,validator(e){return["top","right","bottom","left"].includes(e)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(e){return"string"===typeof e||!1===e}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(e){return["info","error","success","warning"].includes(e)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let e={staticClass:"v-alert__border",class:{[`v-alert__border--${this.border}`]:!0}};return this.coloredBorder&&(e=this.setBackgroundColor(this.computedColor,e),e.class["v-alert__border--has-color"]=!0),this.$createElement("div",e)},__cachedDismissible(){if(!this.dismissible)return null;const e=this.iconColor;return this.$createElement(n.A,{staticClass:"v-alert__dismissible",props:{color:e,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(o.A,{props:{color:e}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(o.A,{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const e={...r.A.options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(e[`v-alert--border-${this.border}`]=!0),e},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&`$${this.type}`)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||a.A.options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&(0,u.q4)("outline","outlined",this)},methods:{genWrapper(){const e=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],t={staticClass:"v-alert__wrapper"};return this.$createElement("div",t,e)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots.default)},genAlert(){let e={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const t=this.hasText?this.setTextColor:this.setBackgroundColor;e=t(this.computedColor,e)}return this.$createElement("div",e,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(e){const t=this.genAlert();return this.transition?e("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[t]):t}})},1231:function(e,t,s){s(125);var r=s(5471),n=s(910),o=s(9463);const i=["sm","md","lg","xl"],a=(()=>i.reduce((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e),{}))(),l=(()=>i.reduce((e,t)=>(e["offset"+(0,o.Zb)(t)]={type:[String,Number],default:null},e),{}))(),c=(()=>i.reduce((e,t)=>(e["order"+(0,o.Zb)(t)]={type:[String,Number],default:null},e),{}))(),d={col:Object.keys(a),offset:Object.keys(l),order:Object.keys(c)};function u(e,t,s){let r=e;if(null!=s&&!1!==s){if(t){const s=t.replace(e,"");r+=`-${s}`}return"col"!==e||""!==s&&!0!==s?(r+=`-${s}`,r.toLowerCase()):r.toLowerCase()}}const h=new Map;t.A=r.Ay.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...a,offset:{type:[String,Number],default:null},...l,order:{type:[String,Number],default:null},...c,alignSelf:{type:String,default:null,validator:e=>["auto","start","end","center","baseline","stretch"].includes(e)},tag:{type:String,default:"div"}},render(e,{props:t,data:s,children:r,parent:o}){let i="";for(const n in t)i+=String(t[n]);let a=h.get(i);if(!a){let e;for(e in a=[],d)d[e].forEach(s=>{const r=t[s],n=u(e,s,r);n&&a.push(n)});const s=a.some(e=>e.startsWith("col-"));a.push({col:!s||!t.cols,[`col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),h.set(i,a)}return e(t.tag,(0,n.Ay)(s,{class:a}),r)}})},2369:function(e,t,s){s(125);var r=s(5471),n=s(910),o=s(9463);const i=["sm","md","lg","xl"],a=["start","end","center"];function l(e,t){return i.reduce((s,r)=>(s[e+(0,o.Zb)(r)]=t(),s),{})}const c=e=>[...a,"baseline","stretch"].includes(e),d=l("align",()=>({type:String,default:null,validator:c})),u=e=>[...a,"space-between","space-around"].includes(e),h=l("justify",()=>({type:String,default:null,validator:u})),p=e=>[...a,"space-between","space-around","stretch"].includes(e),g=l("alignContent",()=>({type:String,default:null,validator:p})),f={align:Object.keys(d),justify:Object.keys(h),alignContent:Object.keys(g)},m={align:"align",justify:"justify",alignContent:"align-content"};function v(e,t,s){let r=m[e];if(null!=s){if(t){const s=t.replace(e,"");r+=`-${s}`}return r+=`-${s}`,r.toLowerCase()}}const y=new Map;t.A=r.Ay.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:c},...d,justify:{type:String,default:null,validator:u},...h,alignContent:{type:String,default:null,validator:p},...g},render(e,{props:t,data:s,children:r}){let o="";for(const n in t)o+=String(t[n]);let i=y.get(o);if(!i){let e;for(e in i=[],f)f[e].forEach(s=>{const r=t[s],n=v(e,s,r);n&&i.push(n)});i.push({"no-gutters":t.noGutters,"row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),y.set(o,i)}return e(t.tag,(0,n.Ay)(s,{staticClass:"row",class:i}),r)}})},8870:function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var r=s(715),n=s(8232),o=s(8047),i=s(1253),a=s(1231),l=s(793),c=s(9975),d=s(6684),u=s(8748),h=s(4026),p=s(7630),g=s(2369),f=function(){var e=this,t=e._self._c;return t(l.A,{attrs:{fluid:""}},[t(g.A,[t(a.A,{attrs:{cols:"12",md:"4"}},[t(o.A,{attrs:{outlined:""}},[t(i.ri,[e._v("Mes séances")]),t(c.A),t(u.A,{attrs:{"two-line":""}},[e._l(e.sessions,function(s){return t(h.A,{key:s.id,class:{"grey lighten-4":e.selectedSession?.id===s.id},on:{click:function(t){return e.selectSession(s)}}},[t(p.pr,[t(p.UZ,[e._v(e._s(s.subject))]),t(p.w,[e._v(" "+e._s(e.formatDate(s.startTime))+" ")])],1)],1)}),e.sessions.length?e._e():t(h.A,[t(p.pr,[e._v("Aucune séance trouvée.")])],1)],2)],1)],1),t(a.A,{attrs:{cols:"12",md:"8"}},[e.selectedSession?t("div",[t(o.A,{staticClass:"mb-4",attrs:{outlined:""}},[t(i.ri,[e._v("Détails de la séance")]),t(i.OQ,[t("session-info",{attrs:{session:e.selectedSession}})],1)],1),t(o.A,{staticClass:"mb-4",attrs:{outlined:""}},[t(i.ri,[e._v("QR Code de présence")]),t(i.OQ,[t("qr-code-generator",{attrs:{sessionId:e.selectedSession.id},on:{"qr-generated":e.handleQrGenerated}})],1)],1),t(n.A,{staticClass:"mb-4",attrs:{color:"primary",loading:e.pdfLoading,disabled:!e.selectedSession},on:{click:e.downloadPdf}},[t(d.A,{attrs:{left:""}},[e._v("mdi-file-pdf-box")]),e._v(" Télécharger la fiche d'émargement ")],1),t(o.A,{attrs:{outlined:""}},[t(i.ri,[e._v("Présences")]),t(i.OQ,[t("attendance-list",{attrs:{attendances:e.attendances},on:{refresh:e.refreshAttendances}})],1)],1)],1):t("div",[t(r.A,{attrs:{type:"info",outlined:""}},[e._v(" Sélectionnez une séance dans la colonne de gauche ")])],1)])],1)],1)},m=[],v=s(5137),y=s(7080),_=function(){var e=this,t=e._self._c;return t(o.A,{staticClass:"mt-4",attrs:{outlined:""}},[t(i.ri,{staticClass:"secondary white--text"},[e._v(" Liste des présences ")]),t(i.OQ,[t(y.A,{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.attendances,"items-per-page":10},scopedSlots:e._u([{key:"item.present",fn:function({item:s}){return[t(v.A,{attrs:{color:s.present?"success":"error",small:""}},[e._v(" "+e._s(s.present?"Présent":"Absent")+" ")])]}}])})],1)],1)},S=[],A={name:"AttendanceList",props:{attendances:{type:Array,required:!0}},data(){return{headers:[{text:"Étudiant",value:"student_name"},{text:"Statut",value:"present"},{text:"Méthode",value:"check_type"},{text:"Validé par",value:"validated_by_name"}]}}},b=A,C=s(1656),$=(0,C.A)(b,_,S,!1,null,null,null),w=$.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"qr-generator"},[t(n.A,{attrs:{color:"primary",loading:e.loading},on:{click:e.generateQr}},[e._v(" Générer QR Code ")]),e.qrUrl?t("div",{staticClass:"mt-4"},[t("img",{staticStyle:{"max-width":"200px"},attrs:{src:e.qrUrl,alt:"QR Code"}}),t("p",{staticClass:"mt-2"},[e._v("Valide jusqu'à: "+e._s(e.expiryTime))])]):e._e(),e.error?t(r.A,{staticClass:"mt-3",attrs:{type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e()],1)},k=[],B=s(2243),j={name:"QrCodeGenerator",props:{sessionId:{type:Number,required:!0}},data(){return{qrUrl:"",expiryTime:"",loading:!1,error:null}},methods:{async generateQr(){this.loading=!0,this.error=null;try{const e=localStorage.getItem("token"),t=await B.A.post("http://localhost:3000/api/qrcode/generate",{sessionId:this.sessionId},{headers:{Authorization:`Bearer ${e}`}});this.qrUrl=t.data.qrCodeUrl,this.expiryTime=new Date(Date.now()+3e5).toLocaleString()}catch(e){console.error("Erreur lors de la génération du QR Code:",e),this.error=e.response?.data?.message||"Erreur inconnue"}finally{this.loading=!1}}}},I=j,D=(0,C.A)(I,x,k,!1,null,null,null),E=D.exports,q=function(){var e=this,t=e._self._c;return t("div",[t("p",[t("strong",[e._v("Sujet :")]),e._v(" "+e._s(e.session.subject))]),t("p",[t("strong",[e._v("Salle :")]),e._v(" "+e._s(e.session.room))]),t("p",[t("strong",[e._v("Début :")]),e._v(" "+e._s(new Date(e.session.startTime).toLocaleString())+" ")]),t("p",[t("strong",[e._v("Fin :")]),e._v(" "+e._s(new Date(e.session.endTime).toLocaleString())+" ")]),e.session.teacher?t("p",[t("strong",[e._v("Enseignant :")]),e._v(" "+e._s(e.session.teacher.firstName)+" "+e._s(e.session.teacher.lastName)+" ")]):e._e()])},L=[],Q={name:"SessionInfo",props:{session:{type:Object,required:!0}}},O=Q,T=(0,C.A)(O,q,L,!1,null,null,null),N=T.exports,P=s(4300),G=s(1152),M={name:"SessionView",components:{SessionInfo:N,QrCodeGenerator:E,AttendanceList:w},data(){return{sessions:[],selectedSession:null,attendances:[],pdfLoading:!1,qrData:null}},async created(){await this.loadSessions()},methods:{formatDate(e){return(0,G.GP)(new Date(e),"dd/MM/yyyy HH:mm")},async loadSessions(){try{const e=await P.A.get("/api/sessions/teacher",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.sessions=e.data}catch(e){console.error("Erreur chargement sessions:",e),this.$toast.error("Erreur lors du chargement des sessions")}},async selectSession(e){this.selectedSession=e,await this.refreshAttendances()},async refreshAttendances(){if(this.selectedSession)try{const e=await P.A.get(`/api/attendances/session/${this.selectedSession.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.attendances=e.data}catch(e){console.error("Erreur chargement présences:",e),this.$toast.error("Erreur lors du chargement des présences")}},async downloadPdf(){if(this.selectedSession){this.pdfLoading=!0;try{window.open(`http://localhost:3000/api/pdf/generate/${this.selectedSession.id}?token=${localStorage.getItem("token")}`,"_blank"),this.$toast.success("PDF généré avec succès")}catch(e){console.error("Erreur téléchargement PDF:",e),this.$toast.error("Erreur lors de la génération du PDF")}finally{this.pdfLoading=!1}}},handleQrGenerated(e){this.qrData=e,this.$toast.success("QR Code généré avec succès")}}},U=M,R=(0,C.A)(U,f,m,!1,null,null,null),z=R.exports}}]);
//# sourceMappingURL=398.2f24cb47.js.map